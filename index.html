<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Hello!</title>
  </head>  
  <body>
    <h1>Reddit Preview Image Link Replacer</h1>
    <p>Replacing preview link from <b>preview.redd.it</b> to <b>i.redd.it</b>.</p>
    
    <form id="myForm">
      Preview Link: <input type="text" id="text-to-replace" value="" onclick="this.select();">
      <input type="button" onclick="myFunction()" value="Replace & Copy">
    </form>

    <!-- Script to replace and copy text -->
    <script>
      function myFunction() {
        var text2replace = document.getElementById("text-to-replace").value;
        var noQueryUrl   = text2replace.split("?")[0];
        var replacedText = noQueryUrl.replace("preview", "i");
        
        var textarea = document.createElement('input');
        textarea.id = "text2copy";
        textarea.value = replacedText;
        document.body.appendChild(textarea);

        var copyText = document.getElementById("text2copy");
        copyText.select();
        copyText.setSelectionRange(0, 99999);

        document.execCommand('copy')
        document.body.removeChild(textarea);
      }
      
      var form = document.getElementById("myForm");
      function handleForm(event) { event.preventDefault(); } 
      form.addEventListener('submit', handleForm);
    </script>
  </body>
</html>
